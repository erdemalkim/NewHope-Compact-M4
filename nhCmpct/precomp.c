#include "inttypes.h"
#include "params.h"

#if (NEWHOPE_N == 512 || NEWHOPE_N == 1024)

/***********************************************************
* Name:        asm_gammas_montgomery
*
* Description: Contains powers of nth root of -1 in Montgomery
*              domain with R=2^16. Note that it is reordered
*              as needed for asm_ntt function.
**********************************************************/
const int16_t asm_gammas_montgomery[NEWHOPE_NTT_LENGTH] = {
// 1 & 2 & 3 layers
2571, 2970, 1812, 1493, 1422, 287, 202,
// 1st loop of 4 & 5 & 6 & 7 layers
3158, 573, 2004, 1223, 652, 2777, 1015, 2226, 430, 555, 843, 2078, 871, 1550, 105,
// 2nd loop of 4 & 5 & 6 & 7 layers
622, 264, 383, 2036, 1491, 3047, 1785, 422, 587, 177, 3094, 3038, 2869, 1574, 1653,
// 3rd loop of 4 & 5 & 6 & 7 layers
1577, 2500, 1458, 516, 3321, 3009, 2663, 3083, 778, 1159, 3182, 2552, 1483, 2727, 1119,
// 4th loop of 4 & 5 & 6 & 7 layers
182, 1727, 3199, 1711, 2167, 126, 1469, 1739, 644, 2457, 349, 418, 329, 3173, 3254,
// 5th loop of 4 & 5 & 6 & 7 layers
962, 2648, 1017, 2476, 3239, 3058, 830, 817, 1097, 603, 610, 1322, 2044, 1864, 384,
// 6th loop of 4 & 5 & 6 & 7 layers
2127, 732, 608, 107, 1908, 3082, 2378, 2114, 3193, 1218, 1994, 2455, 220, 2142, 1670,
// 7th loop of 4 & 5 & 6 & 7 layers
1855, 1787, 411, 2931, 961, 1821, 2604, 2144, 1799, 2051, 794, 1819, 2475, 2459, 478,
// 8th loop of 4 & 5 & 6 & 7 layers
1468, 3124, 1758, 448, 2264, 677, 2054, 3221, 3021, 996, 991, 958, 1869, 1522, 1628,
};

/* Precomputed NTT contants generated by Pari/GP script as follows:

  For n = 512 and n = 1024:

  brv = [\
    0, 64, 32, 96,  16, 80, 48, 112, 8,  72, 40, 104, 24, 88, 56, 120,\
    4, 68, 36, 100, 20, 84, 52, 116, 12, 76, 44, 108, 28, 92, 60, 124,\
    2, 66, 34, 98,  18, 82, 50, 114, 10, 74, 42, 106, 26, 90, 58, 122,\
    6, 70, 38, 102, 22, 86, 54, 118, 14, 78, 46, 110, 30, 94, 62, 126,\
    1, 65, 33, 97,  17, 81, 49, 113, 9,  73, 41, 105, 25, 89, 57, 121,\
    5, 69, 37, 101, 21, 85, 53, 117, 13, 77, 45, 109, 29, 93, 61, 125,\
    3, 67, 35, 99,  19, 83, 51, 115, 11, 75, 43, 107, 27, 91, 59, 123,\
    7, 71, 39, 103, 23, 87, 55, 119, 15, 79, 47, 111, 31, 95, 63, 127];

  n = 128; q = 3329; mont = 2^16;
  g = Mod(17,q);
  gammas_bitrev_montgomery = lift(vector(n/2, i, g^(brv[i+64])*mont));
*/
/***********************************************************
* Name:        asm_gammas_montgomery_mul
*
* Description: Contains brv[64]^th to brv[128]^th powers of
*              nth root of -1 in Montgomery domain with R=2^16.
**********************************************************/
const int16_t asm_gammas_montgomery_mul[NEWHOPE_NTT_LENGTH/2] = {
  2226, 430, 555, 843, 2078, 871, 1550, 105, 422, 587, 177, 3094, 3038, 2869, 1574, 1653,
  3083, 778, 1159, 3182, 2552, 1483, 2727, 1119, 1739, 644, 2457, 349, 418, 329, 3173, 3254,
  817, 1097, 603, 610, 1322, 2044, 1864, 384, 2114, 3193, 1218, 1994, 2455, 220, 2142, 1670,
  2144, 1799, 2051, 794, 1819, 2475, 2459, 478, 3221, 3021, 996, 991, 958, 1869, 1522, 1628,
};

/***********************************************************
* Name:        asm_gammas_inv_montgomery
*
* Description: Contains inverse powers of nth root of -1 in Montgomery
*              domain with R=2^16. Note that it is reordered
*              as needed for asm_invntt function.
**********************************************************/
const int16_t asm_gammas_inv_montgomery[NEWHOPE_NTT_LENGTH] = {
// 1st loop of 7 & 6 & 5 & 4 layers
1701, 1807, 1460, 2371, 2338, 2333, 308, 108, 1275, 2652, 1065, 2881, 1571, 205, 1861,
// 2nd loop of 7 & 6 & 5 & 4 layers
2851, 870, 854, 1510, 2535, 1278, 1530, 1185, 725, 1508, 2368, 398, 2918, 1542, 1474,
// 3rd loop of 7 & 6 & 5 & 4 layers
1659, 1187, 3109, 874, 1335, 2111, 136, 1215, 951, 247, 1421, 3222, 2721, 2597, 1202,
// 4th loop of 7 & 6 & 5 & 4 layers
2945, 1465, 1285, 2007, 2719, 2726, 2232, 2512, 2499, 271, 90, 853, 2312, 681, 2367,
// 5th loop of 7 & 6 & 5 & 4 layers
75, 156, 3000, 2911, 2980, 872, 2685, 1590, 1860, 3203, 1162, 1618, 130, 1602, 3147,
// 6th loop of 7 & 6 & 5 & 4 layers
2210, 602, 1846, 777, 147, 2170, 2551, 246, 666, 320, 8, 2813, 1871, 829, 1752,
// 7th loop of 7 & 6 & 5 & 4 layers
1676, 1755, 460, 291, 235, 3152, 2742, 2907, 1544, 282, 1838, 1293, 2946, 3065, 2707,
// 8th loop of 7 & 6 & 5 & 4 layers
3224, 1779, 2458, 1251, 2486, 2774, 2899, 1103, 2314, 552, 2677, 2106, 1325, 2756, 171,
// 3 & 2 & 1 layers
3127, 3042, 1907, 1836, 1517, 359, 1932,
// 128^-1 * 2^32
1441
};

#elif (NEWHOPE_N == 768)

/***********************************************************
* Name:        asm_gammas_montgomery
*
* Description: Contains powers of nth root of -1 in Montgomery
*              domain with R=2^16. Note that it is reordered
*              as needed for asm_ntt function.
**********************************************************/
const int16_t asm_gammas_montgomery[NEWHOPE_NTT_LENGTH] = {
// 1 & 2 & 3 layers
2424, 1886, 1937, 1715, 2644, 2833, 2753,
// 1st loop of 4 & 5 & 6 & 7 layers
16, 1024, 978, 1278, 910, 2147, 1004, 2286, 2845, 919, 2721, 2409, 2186, 728, 3126,
// 2nd loop of 4 & 5 & 6 & 7 layers
2500, 2429, 1854, 1129, 2692, 2013, 2537, 878, 636, 604, 1036, 2377, 643, 328, 2852,
// 3rd loop of 4 & 5 & 6 & 7 layers
200, 3166, 2065, 3349, 410, 2107, 1668, 126, 674, 1575, 1511, 160, 801, 2000, 1370,
// 4th loop of 4 & 5 & 6 & 7 layers
137, 1548, 3342, 2826, 795, 755, 1295, 2716, 2621, 2837, 3378, 376, 3438, 1243, 1491,
// 5th loop of 4 & 5 & 6 & 7 layers
2946, 729, 2418, 2, 2041, 25, 3042, 1008, 1935, 2229, 1717, 1280, 2951, 2172, 589,
// 6th loop of 4 & 5 & 6 & 7 layers
2260, 470, 2569, 1100, 2482, 3379, 3369, 986, 226, 1954, 2825, 3008, 3305, 3030, 1557,
// 7th loop of 4 & 5 & 6 & 7 layers
2255, 3395, 2412, 3116, 2895, 923, 3346, 110, 1631, 1375, 1374, 1731, 1687, 2624, 2074,
// 8th loop of 4 & 5 & 6 & 7 layers
594, 2682, 2494, 2585, 2030, 2928, 1176, 1987, 203, 2367, 809, 438, 1026, 2018, 2454
};

/* Precomputed NTT contants generated by Pari/GP script as follows:

  For n = 768:

  brv=[\
    1, 64, 32, 160, 16, 112, 80, 176, 8, 104, 56, 152, 40, 136, 88, 184,\
    4, 100, 52, 148, 28, 124, 76, 172, 20, 116, 68, 164, 44, 140, 92, 188,\
    2, 98, 50, 146, 26, 122, 74, 170, 14, 110, 62, 158, 38, 134, 86, 182,\
    10, 106, 58, 154, 34, 130, 82, 178, 22, 118, 70, 166, 46, 142, 94, 190,\
    1, 97, 49, 145, 25, 121, 73, 169, 13, 109, 61, 157, 37, 133, 85, 181,\
    7, 103, 55, 151, 31, 127, 79, 175, 19, 115, 67, 163, 43, 139, 91, 187,\
    5, 101, 53,  149, 29, 125, 77, 173, 17, 113, 65, 161, 41, 137, 89, 185,\
    11, 107, 59, 155, 35, 131, 83, 179, 23, 119, 71, 167, 47, 143, 95, 191];

  n = 128; q = 3457; mont = 2^16;
  g = Mod(55,q);
  gammas_bitrev_montgomery = lift(vector(n/2, i, g^(brv[i+64])*mont));
*/
/***********************************************************
* Name:        asm_gammas_montgomery_mul
*
* Description: Contains brv[64]^th to brv[128]^th powers of
*              nth root of -1 in Montgomery domain with R=2^16.
**********************************************************/
const int16_t asm_gammas_montgomery_mul[NEWHOPE_NTT_LENGTH/2] = {
  2286, 2845, 919, 2721, 2409, 2186, 728, 3126, 878, 636, 604, 1036, 2377, 643, 328, 2852,
  126, 674, 1575, 1511, 160, 801, 2000, 1370, 2716, 2621, 2837, 3378, 376, 3438, 1243, 1491,
  1008, 1935, 2229, 1717, 1280, 2951, 2172, 589, 986, 226, 1954, 2825, 3008, 3305, 3030, 1557,
  110, 1631, 1375, 1374, 1731, 1687, 2624, 2074, 1987, 203, 2367, 809, 438, 1026, 2018, 2454,
};

/***********************************************************
* Name:        asm_gammas_inv_montgomery
*
* Description: Contains inverse powers of nth root of -1 in Montgomery
*              domain with R=2^16. Note that it is reordered
*              as needed for asm_invntt function.
**********************************************************/
const int16_t asm_gammas_inv_montgomery[NEWHOPE_NTT_LENGTH+1] = {
// 1th loop of 7 & 6 & 5 & 4 layers
1003, 1439, 2431, 3019, 2648, 1090, 3254, 1470, 2281, 529, 1427, 872, 963, 775, 2863,
// 2nd loop of 7 & 6 & 5 & 4 layers
1383, 833, 1770, 1726, 2083, 2082, 1826, 3347, 111, 2534, 562, 341, 1045, 62, 1202,
// 3rd loop of 7 & 6 & 5 & 4 layers
1900, 427, 152, 449, 632, 1503, 3231, 2471, 88, 78, 975, 2357, 888, 2987, 1197,
// 4th loop of 7 & 6 & 5 & 4 layers
2868, 1285, 506, 2177, 1740, 1228, 1522, 2449, 415, 3432, 1416, 3455, 1039, 2728, 511,
// 5th loop of 7 & 6 & 5 & 4 layers
1966, 2214, 19, 3081, 79, 620, 836, 741, 2162, 2702, 2662, 631, 115, 1909, 3320,
// 6th loop of 7 & 6 & 5 & 4 layers
2087, 1457, 2656, 3297, 1946, 1882, 2783, 3331, 1789, 1350, 3047, 108, 1392, 291, 3257,
// 7th loop of 7 & 6 & 5 & 4 layers
605, 3129, 2814, 1080, 2421, 2853, 2821, 2579, 920, 1444, 765, 2328, 1603, 1028, 957,
// 8th loop of 7 & 6 & 5 & 4 layers
331, 2729, 1271, 1048, 736, 2538, 612, 1171, 2453, 1310, 2547, 2179, 2479, 2433, 3441,
// 3 & 2 & 1 layers
704, 624, 813, 1742, 1520, 1571, 1792,
// 128^-1 * 2^32, 64^-1 * 2^32
790, 1580,
};

#else
#error "NEWHOPE_N must be either 512, 768 or 1024"
#endif
